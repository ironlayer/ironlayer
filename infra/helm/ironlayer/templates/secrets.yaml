{{/*
============================================================================
IronLayer Secrets -- Opaque secret holding sensitive credentials
============================================================================
In production, prefer an external secrets operator (e.g. Vault, AWS Secrets
Manager, SOPS) rather than storing values in Helm overrides.  This resource
exists for bootstrapping and development convenience.
*/}}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "ironlayer.secretName" . }}
  labels:
    {{- include "ironlayer.labels" . | nindent 4 }}
    app.kubernetes.io/name: {{ include "ironlayer.name" . }}
    app.kubernetes.io/instance: {{ .Release.Name }}
type: Opaque
data:
  # Full asyncpg connection string for the API and Alembic migrations.
  database-url: {{ .Values.secrets.databaseUrl | b64enc | quote }}
  # JWT signing secret used by the API authentication layer.
  jwt-secret: {{ .Values.secrets.jwtSecret | b64enc | quote }}
  {{- if .Values.secrets.llmApiKey }}
  # LLM provider API key consumed by the AI engine (optional).
  llm-api-key: {{ .Values.secrets.llmApiKey | b64enc | quote }}
  {{- end }}
